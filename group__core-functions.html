<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.5"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>VMC project: Core functions</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">VMC project
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.5 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">Core functions</div></div>
</div><!--header-->
<div class="contents">

<p>The most important functions in the code.  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ga8d5dd8844e5352857ff16e46a8add656"><td class="memTemplParams" colspan="2">template&lt;<a class="el" href="group__lexic-types.html#gac054642b806e57a890d98da54fc37d8b">Dimension</a> D, <a class="el" href="group__lexic-types.html#ga7180e1fd6dc0f5d4711ca838823f55c3">ParticNum</a> N&gt; </td></tr>
<tr class="memitem:ga8d5dd8844e5352857ff16e46a8add656"><td class="memTemplItemLeft" align="right" valign="top"><a class="el" href="structvmcp_1_1BlockingResult.html">BlockingResult</a>&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="group__core-functions.html#ga8d5dd8844e5352857ff16e46a8add656">vmcp::EvalBlocking</a> (std::vector&lt; <a class="el" href="structvmcp_1_1LocEnAndPoss.html">LocEnAndPoss</a>&lt; D, N &gt; &gt; const &amp;energies)</td></tr>
<tr class="memdesc:ga8d5dd8844e5352857ff16e46a8add656"><td class="mdescLeft">&#160;</td><td class="mdescRight">Core helper method for Blocking, divides dataset into multiple blocks with a certain block size, then evaluates means of each block and takes the mean of means and standard deviation of means (for each block size)  <a href="group__core-functions.html#ga8d5dd8844e5352857ff16e46a8add656">More...</a><br /></td></tr>
<tr class="separator:ga8d5dd8844e5352857ff16e46a8add656"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga4f062a3af7693ab4e6fcbf1e95567cd9"><td class="memTemplParams" colspan="2">template&lt;<a class="el" href="group__lexic-types.html#gac054642b806e57a890d98da54fc37d8b">Dimension</a> D, <a class="el" href="group__lexic-types.html#ga7180e1fd6dc0f5d4711ca838823f55c3">ParticNum</a> N&gt; </td></tr>
<tr class="memitem:ga4f062a3af7693ab4e6fcbf1e95567cd9"><td class="memTemplItemLeft" align="right" valign="top"><a class="el" href="structvmcp_1_1Energy.html">Energy</a>&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="group__core-functions.html#ga4f062a3af7693ab4e6fcbf1e95567cd9">vmcp::BlockingAnalysis</a> (std::vector&lt; <a class="el" href="structvmcp_1_1LocEnAndPoss.html">LocEnAndPoss</a>&lt; D, N &gt; &gt; const &amp;energies)</td></tr>
<tr class="memdesc:ga4f062a3af7693ab4e6fcbf1e95567cd9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Takes the result of EvalBlocking and then looks for the plateau of standard deviation to get the best estimate of the error.  <a href="group__core-functions.html#ga4f062a3af7693ab4e6fcbf1e95567cd9">More...</a><br /></td></tr>
<tr class="separator:ga4f062a3af7693ab4e6fcbf1e95567cd9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga83a2125adfc9949b200357cda3cdd47f"><td class="memTemplParams" colspan="2">template&lt;<a class="el" href="group__lexic-types.html#gac054642b806e57a890d98da54fc37d8b">Dimension</a> D, <a class="el" href="group__lexic-types.html#ga7180e1fd6dc0f5d4711ca838823f55c3">ParticNum</a> N&gt; </td></tr>
<tr class="memitem:ga83a2125adfc9949b200357cda3cdd47f"><td class="memTemplItemLeft" align="right" valign="top"><a class="el" href="structvmcp_1_1Energy.html">Energy</a>&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="group__core-functions.html#ga83a2125adfc9949b200357cda3cdd47f">vmcp::BootstrapAnalysis</a> (std::vector&lt; <a class="el" href="structvmcp_1_1LocEnAndPoss.html">LocEnAndPoss</a>&lt; D, N &gt; &gt; const &amp;energies, <a class="el" href="group__struct-types.html#ga829e1dd0a0d9ef3e7e95aa986d6edb7d">IntType</a> const &amp;boostrapSamples, <a class="el" href="group__struct-types.html#gac38d2867cc2daa23c78b29eee019cf9d">RandomGenerator</a> &amp;gen)</td></tr>
<tr class="memdesc:ga83a2125adfc9949b200357cda3cdd47f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Samples dataset with replacement multiple times, then evaluates mean and standard deviation of each sample and takes the mean these values.  <a href="group__core-functions.html#ga83a2125adfc9949b200357cda3cdd47f">More...</a><br /></td></tr>
<tr class="separator:ga83a2125adfc9949b200357cda3cdd47f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga371210c4ebea151431d06853e1ceabbd"><td class="memTemplParams" colspan="2">template&lt;<a class="el" href="group__lexic-types.html#gac054642b806e57a890d98da54fc37d8b">Dimension</a> D, <a class="el" href="group__lexic-types.html#ga7180e1fd6dc0f5d4711ca838823f55c3">ParticNum</a> N, <a class="el" href="group__lexic-types.html#ga6bd28161ae7a0119b328705a0fc07441">VarParNum</a> V, class Wavefunction , class FirstDerivative , class Laplacian , class Potential &gt; </td></tr>
<tr class="memitem:ga371210c4ebea151431d06853e1ceabbd"><td class="memTemplItemLeft" align="right" valign="top">std::vector&lt; <a class="el" href="structvmcp_1_1LocEnAndPoss.html">LocEnAndPoss</a>&lt; D, N &gt; &gt;&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="group__core-functions.html#ga371210c4ebea151431d06853e1ceabbd">vmcp::VMCLocEnAndPoss_</a> (Wavefunction const &amp;wavef, <a class="el" href="group__lexic-types.html#gae475ef5e3e9892bda5e56c3f9a2805f8">Positions</a>&lt; D, N &gt; poss, <a class="el" href="group__lexic-types.html#ga056b415cd8cb5c6ea875f449f819645c">VarParams</a>&lt; V &gt; params, bool useAnalytical, bool useImpSamp, <a class="el" href="group__lexic-types.html#gacbb288b363a4bede2f0cae3789213429">Gradients</a>&lt; D, N, FirstDerivative &gt; const &amp;grads, <a class="el" href="group__lexic-types.html#gac062c0a404e4f9c5ab2abf106159e748">Laplacians</a>&lt; N, Laplacian &gt; const &amp;lapls, <a class="el" href="group__struct-types.html#gac145db31e9e1e78140de8a017a285fda">FPType</a> derivativeStep, <a class="el" href="group__lexic-types.html#ga1b2702a1bf310abc1db6102bda6731d9">Masses</a>&lt; N &gt; masses, Potential const &amp;pot, <a class="el" href="group__lexic-types.html#ga7848d17db41038597ab54fa2c16653a3">CoordBounds</a>&lt; D &gt; bounds, <a class="el" href="group__struct-types.html#ga829e1dd0a0d9ef3e7e95aa986d6edb7d">IntType</a> numEnergies, <a class="el" href="group__struct-types.html#gac38d2867cc2daa23c78b29eee019cf9d">RandomGenerator</a> &amp;gen)</td></tr>
<tr class="memdesc:ga371210c4ebea151431d06853e1ceabbd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Computes the energies that will be averaged to obtain the estimate of the energy.  <a href="group__core-functions.html#ga371210c4ebea151431d06853e1ceabbd">More...</a><br /></td></tr>
<tr class="separator:ga371210c4ebea151431d06853e1ceabbd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaa42a5ef30360b85db8949f1849172bb5"><td class="memTemplParams" colspan="2">template&lt;<a class="el" href="group__lexic-types.html#gac054642b806e57a890d98da54fc37d8b">Dimension</a> D, <a class="el" href="group__lexic-types.html#ga7180e1fd6dc0f5d4711ca838823f55c3">ParticNum</a> N, <a class="el" href="group__lexic-types.html#ga6bd28161ae7a0119b328705a0fc07441">VarParNum</a> V, class Wavefunction , class LocEnAndPossCalculator &gt; </td></tr>
<tr class="memitem:gaa42a5ef30360b85db8949f1849172bb5"><td class="memTemplItemLeft" align="right" valign="top"><a class="el" href="structvmcp_1_1VMCResult.html">VMCResult</a>&lt; V &gt;&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="group__core-functions.html#gaa42a5ef30360b85db8949f1849172bb5">vmcp::VMCRBestParams_</a> (<a class="el" href="group__lexic-types.html#ga056b415cd8cb5c6ea875f449f819645c">VarParams</a>&lt; V &gt; initialParams, <a class="el" href="group__lexic-types.html#gacccffa7caec2adfb7d3ea5c2244422eb">ParamBounds</a>&lt; V &gt; bounds, Wavefunction const &amp;wavef, LocEnAndPossCalculator const &amp;lepsCalc, <a class="el" href="group__lexic-types.html#ga425e16aae8ec073f46fa42f58a3e96a5">StatFuncType</a> function, <a class="el" href="group__struct-types.html#ga829e1dd0a0d9ef3e7e95aa986d6edb7d">IntType</a> const &amp;boostrapSamples, <a class="el" href="group__struct-types.html#gac38d2867cc2daa23c78b29eee019cf9d">RandomGenerator</a> &amp;gen)</td></tr>
<tr class="memdesc:gaa42a5ef30360b85db8949f1849172bb5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Computes the energy with error, with the parameters that minimize the former.  <a href="group__core-functions.html#gaa42a5ef30360b85db8949f1849172bb5">More...</a><br /></td></tr>
<tr class="separator:gaa42a5ef30360b85db8949f1849172bb5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga55dc45dd72900b5ef725da2678285f19"><td class="memTemplParams" colspan="2">template&lt;<a class="el" href="group__lexic-types.html#gac054642b806e57a890d98da54fc37d8b">Dimension</a> D, <a class="el" href="group__lexic-types.html#ga7180e1fd6dc0f5d4711ca838823f55c3">ParticNum</a> N, <a class="el" href="group__lexic-types.html#ga6bd28161ae7a0119b328705a0fc07441">VarParNum</a> V, class Wavefunction , class LocEnAndPossCalculator &gt; </td></tr>
<tr class="memitem:ga55dc45dd72900b5ef725da2678285f19"><td class="memTemplItemLeft" align="right" valign="top"><a class="el" href="structvmcp_1_1VMCResult.html">VMCResult</a>&lt; V &gt;&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="group__core-functions.html#ga55dc45dd72900b5ef725da2678285f19">vmcp::VMCRBestParams_</a> (<a class="el" href="group__lexic-types.html#gacccffa7caec2adfb7d3ea5c2244422eb">ParamBounds</a>&lt; V &gt; bounds, Wavefunction const &amp;wavef, LocEnAndPossCalculator const &amp;lepsCalc, <a class="el" href="group__struct-types.html#ga829e1dd0a0d9ef3e7e95aa986d6edb7d">IntType</a> numWalkers, <a class="el" href="group__lexic-types.html#ga425e16aae8ec073f46fa42f58a3e96a5">StatFuncType</a> function, <a class="el" href="group__struct-types.html#ga829e1dd0a0d9ef3e7e95aa986d6edb7d">IntType</a> const &amp;boostrapSamples, <a class="el" href="group__struct-types.html#gac38d2867cc2daa23c78b29eee019cf9d">RandomGenerator</a> &amp;gen)</td></tr>
<tr class="memdesc:ga55dc45dd72900b5ef725da2678285f19"><td class="mdescLeft">&#160;</td><td class="mdescRight">Computes the energy with error, with the parameters that minimize the former.  <a href="group__core-functions.html#ga55dc45dd72900b5ef725da2678285f19">More...</a><br /></td></tr>
<tr class="separator:ga55dc45dd72900b5ef725da2678285f19"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<p >The most important functions in the code. </p>
<p >The ones that actually do the work.</p>
<p >The ones that actually do the work. </p>
<h2 class="groupheader">Function Documentation</h2>
<a id="ga4f062a3af7693ab4e6fcbf1e95567cd9" name="ga4f062a3af7693ab4e6fcbf1e95567cd9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga4f062a3af7693ab4e6fcbf1e95567cd9">&#9670;&#160;</a></span>BlockingAnalysis()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;<a class="el" href="group__lexic-types.html#gac054642b806e57a890d98da54fc37d8b">Dimension</a> D, <a class="el" href="group__lexic-types.html#ga7180e1fd6dc0f5d4711ca838823f55c3">ParticNum</a> N&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structvmcp_1_1Energy.html">Energy</a> vmcp::BlockingAnalysis </td>
          <td>(</td>
          <td class="paramtype">std::vector&lt; <a class="el" href="structvmcp_1_1LocEnAndPoss.html">LocEnAndPoss</a>&lt; D, N &gt; &gt; const &amp;&#160;</td>
          <td class="paramname"><em>energies</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Takes the result of EvalBlocking and then looks for the plateau of standard deviation to get the best estimate of the error. </p>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__core-functions.html#ga8d5dd8844e5352857ff16e46a8add656" title="Core helper method for Blocking, divides dataset into multiple blocks with a certain block size,...">EvalBlocking</a></dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">energies</td><td>The energies and positions, where only the energies will be used </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The best standard deviation</dd></dl>
<p>EvalBlocking also returns "blockSizes" and "means". They are not used by BlockingAnalysis, they are used for testing blocking method </p>

<p class="definition">Definition at line <a class="el" href="statistics_8inl_source.html#l00267">267</a> of file <a class="el" href="statistics_8inl_source.html">statistics.inl</a>.</p>

</div>
</div>
<a id="ga83a2125adfc9949b200357cda3cdd47f" name="ga83a2125adfc9949b200357cda3cdd47f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga83a2125adfc9949b200357cda3cdd47f">&#9670;&#160;</a></span>BootstrapAnalysis()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;<a class="el" href="group__lexic-types.html#gac054642b806e57a890d98da54fc37d8b">Dimension</a> D, <a class="el" href="group__lexic-types.html#ga7180e1fd6dc0f5d4711ca838823f55c3">ParticNum</a> N&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structvmcp_1_1Energy.html">Energy</a> vmcp::BootstrapAnalysis </td>
          <td>(</td>
          <td class="paramtype">std::vector&lt; <a class="el" href="structvmcp_1_1LocEnAndPoss.html">LocEnAndPoss</a>&lt; D, N &gt; &gt; const &amp;&#160;</td>
          <td class="paramname"><em>energies</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__struct-types.html#ga829e1dd0a0d9ef3e7e95aa986d6edb7d">IntType</a> const &amp;&#160;</td>
          <td class="paramname"><em>boostrapSamples</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__struct-types.html#gac38d2867cc2daa23c78b29eee019cf9d">RandomGenerator</a> &amp;&#160;</td>
          <td class="paramname"><em>gen</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Samples dataset with replacement multiple times, then evaluates mean and standard deviation of each sample and takes the mean these values. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">energies</td><td>The energies and positions, where only the energies will be used </td></tr>
    <tr><td class="paramname">boostrapSamples</td><td>The number of samples that will be generated </td></tr>
    <tr><td class="paramname">gen</td><td>The random generator </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The mean and standard deviation of bootstrapped samples </dd></dl>

<p class="definition">Definition at line <a class="el" href="statistics_8inl_source.html#l00292">292</a> of file <a class="el" href="statistics_8inl_source.html">statistics.inl</a>.</p>

</div>
</div>
<a id="ga8d5dd8844e5352857ff16e46a8add656" name="ga8d5dd8844e5352857ff16e46a8add656"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga8d5dd8844e5352857ff16e46a8add656">&#9670;&#160;</a></span>EvalBlocking()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;<a class="el" href="group__lexic-types.html#gac054642b806e57a890d98da54fc37d8b">Dimension</a> D, <a class="el" href="group__lexic-types.html#ga7180e1fd6dc0f5d4711ca838823f55c3">ParticNum</a> N&gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structvmcp_1_1BlockingResult.html">BlockingResult</a> vmcp::EvalBlocking </td>
          <td>(</td>
          <td class="paramtype">std::vector&lt; <a class="el" href="structvmcp_1_1LocEnAndPoss.html">LocEnAndPoss</a>&lt; D, N &gt; &gt; const &amp;&#160;</td>
          <td class="paramname"><em>energies</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Core helper method for Blocking, divides dataset into multiple blocks with a certain block size, then evaluates means of each block and takes the mean of means and standard deviation of means (for each block size) </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">energies</td><td>The energies and positions, where only the energies will be used </td></tr>
  </table>
  </dd>
</dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__core-functions.html#ga4f062a3af7693ab4e6fcbf1e95567cd9" title="Takes the result of EvalBlocking and then looks for the plateau of standard deviation to get the best...">BlockingAnalysis</a></dd></dl>
<dl class="section return"><dt>Returns</dt><dd>Three vectors containing respectively a list of block sizes, means and standard deviations </dd></dl>

<p class="definition">Definition at line <a class="el" href="statistics_8inl_source.html#l00225">225</a> of file <a class="el" href="statistics_8inl_source.html">statistics.inl</a>.</p>

</div>
</div>
<a id="ga371210c4ebea151431d06853e1ceabbd" name="ga371210c4ebea151431d06853e1ceabbd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga371210c4ebea151431d06853e1ceabbd">&#9670;&#160;</a></span>VMCLocEnAndPoss_()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;<a class="el" href="group__lexic-types.html#gac054642b806e57a890d98da54fc37d8b">Dimension</a> D, <a class="el" href="group__lexic-types.html#ga7180e1fd6dc0f5d4711ca838823f55c3">ParticNum</a> N, <a class="el" href="group__lexic-types.html#ga6bd28161ae7a0119b328705a0fc07441">VarParNum</a> V, class Wavefunction , class FirstDerivative , class Laplacian , class Potential &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; <a class="el" href="structvmcp_1_1LocEnAndPoss.html">LocEnAndPoss</a>&lt; D, N &gt; &gt; vmcp::VMCLocEnAndPoss_ </td>
          <td>(</td>
          <td class="paramtype">Wavefunction const &amp;&#160;</td>
          <td class="paramname"><em>wavef</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__lexic-types.html#gae475ef5e3e9892bda5e56c3f9a2805f8">Positions</a>&lt; D, N &gt;&#160;</td>
          <td class="paramname"><em>poss</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__lexic-types.html#ga056b415cd8cb5c6ea875f449f819645c">VarParams</a>&lt; V &gt;&#160;</td>
          <td class="paramname"><em>params</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>useAnalytical</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>useImpSamp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__lexic-types.html#gacbb288b363a4bede2f0cae3789213429">Gradients</a>&lt; D, N, FirstDerivative &gt; const &amp;&#160;</td>
          <td class="paramname"><em>grads</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__lexic-types.html#gac062c0a404e4f9c5ab2abf106159e748">Laplacians</a>&lt; N, Laplacian &gt; const &amp;&#160;</td>
          <td class="paramname"><em>lapls</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__struct-types.html#gac145db31e9e1e78140de8a017a285fda">FPType</a>&#160;</td>
          <td class="paramname"><em>derivativeStep</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__lexic-types.html#ga1b2702a1bf310abc1db6102bda6731d9">Masses</a>&lt; N &gt;&#160;</td>
          <td class="paramname"><em>masses</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Potential const &amp;&#160;</td>
          <td class="paramname"><em>pot</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__lexic-types.html#ga7848d17db41038597ab54fa2c16653a3">CoordBounds</a>&lt; D &gt;&#160;</td>
          <td class="paramname"><em>bounds</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__struct-types.html#ga829e1dd0a0d9ef3e7e95aa986d6edb7d">IntType</a>&#160;</td>
          <td class="paramname"><em>numEnergies</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__struct-types.html#gac38d2867cc2daa23c78b29eee019cf9d">RandomGenerator</a> &amp;&#160;</td>
          <td class="paramname"><em>gen</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Computes the energies that will be averaged to obtain the estimate of the energy. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">wavef</td><td>The wavefunction </td></tr>
    <tr><td class="paramname">params</td><td>The variational parameters </td></tr>
    <tr><td class="paramname">useAnalytical</td><td>Whether the local energy must be computed by using the analytical expression of the laplacians </td></tr>
    <tr><td class="paramname">useImpSamp</td><td>Whether to use importance sampling as the update algorithm (the alternative is Metropolis) </td></tr>
    <tr><td class="paramname">grads</td><td>The gradients of the particles (unused if 'useAnalytical == false' or 'useImpSamp == false') </td></tr>
    <tr><td class="paramname">lapls</td><td>The laplacians of the particles (unused if 'useAnalytical == false') </td></tr>
    <tr><td class="paramname">derivativeStep</td><td>The step used is the numerical estimation of the derivative (unused if 'useAnalytical == true') </td></tr>
    <tr><td class="paramname">masses</td><td>The masses of the particles </td></tr>
    <tr><td class="paramname">pot</td><td>The potential </td></tr>
    <tr><td class="paramname">bounds</td><td>The integration region </td></tr>
    <tr><td class="paramname">numEnergies</td><td>The number of energies to compute </td></tr>
    <tr><td class="paramname">gen</td><td>The random generator </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The computed local energies, and the positions of the particles when each local energy was computed</dd></dl>
<p>Is the most important function of the library, since is the one which actually does the work. Starts from a point where the potential is sufficiently large, to quickly forget about the initial conditions. Does some updates to move away from the starting point, then starts computing the local energies. In between two evaluations of the local energy, some updates are done to avoid correlations. Adjusts the step size on the fly to best match the target acceptance rate. Depending on 'useAnalytical' and 'useImpSamp', some parameters are unused. To avoid having the user supply some parameters he does not care about, wrappers that only ask for the necessary ones are provided. </p>

<p class="definition">Definition at line <a class="el" href="vmcalgs_8inl_source.html#l00056">56</a> of file <a class="el" href="vmcalgs_8inl_source.html">vmcalgs.inl</a>.</p>

</div>
</div>
<a id="ga55dc45dd72900b5ef725da2678285f19" name="ga55dc45dd72900b5ef725da2678285f19"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ga55dc45dd72900b5ef725da2678285f19">&#9670;&#160;</a></span>VMCRBestParams_() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;<a class="el" href="group__lexic-types.html#gac054642b806e57a890d98da54fc37d8b">Dimension</a> D, <a class="el" href="group__lexic-types.html#ga7180e1fd6dc0f5d4711ca838823f55c3">ParticNum</a> N, <a class="el" href="group__lexic-types.html#ga6bd28161ae7a0119b328705a0fc07441">VarParNum</a> V, class Wavefunction , class LocEnAndPossCalculator &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structvmcp_1_1VMCResult.html">VMCResult</a>&lt; V &gt; vmcp::VMCRBestParams_ </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__lexic-types.html#gacccffa7caec2adfb7d3ea5c2244422eb">ParamBounds</a>&lt; V &gt;&#160;</td>
          <td class="paramname"><em>bounds</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Wavefunction const &amp;&#160;</td>
          <td class="paramname"><em>wavef</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">LocEnAndPossCalculator const &amp;&#160;</td>
          <td class="paramname"><em>lepsCalc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__struct-types.html#ga829e1dd0a0d9ef3e7e95aa986d6edb7d">IntType</a>&#160;</td>
          <td class="paramname"><em>numWalkers</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__lexic-types.html#ga425e16aae8ec073f46fa42f58a3e96a5">StatFuncType</a>&#160;</td>
          <td class="paramname"><em>function</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__struct-types.html#ga829e1dd0a0d9ef3e7e95aa986d6edb7d">IntType</a> const &amp;&#160;</td>
          <td class="paramname"><em>boostrapSamples</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__struct-types.html#gac38d2867cc2daa23c78b29eee019cf9d">RandomGenerator</a> &amp;&#160;</td>
          <td class="paramname"><em>gen</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Computes the energy with error, with the parameters that minimize the former. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">bounds</td><td>The interval in which the best parameters should be found </td></tr>
    <tr><td class="paramname">wavef</td><td>The wavefunction </td></tr>
    <tr><td class="paramname">lepsCalc</td><td>A function that takes as input the variational parameters and returns the local energies and the positions of the particles when each one was computed </td></tr>
    <tr><td class="paramname">numWalkers</td><td>The number of independent gradient descents carried out </td></tr>
    <tr><td class="paramname">gen</td><td>The random generator </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The energy with error</dd></dl>
<p>Carries out 'numWalkers' gradient descents in parallel, and at the end chooses the lowest energy obtained. The starting parameters of the walkers are chosen randomly inside 'bounds' </p>

<p class="definition">Definition at line <a class="el" href="vmcalgs_8inl_source.html#l00223">223</a> of file <a class="el" href="vmcalgs_8inl_source.html">vmcalgs.inl</a>.</p>

</div>
</div>
<a id="gaa42a5ef30360b85db8949f1849172bb5" name="gaa42a5ef30360b85db8949f1849172bb5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#gaa42a5ef30360b85db8949f1849172bb5">&#9670;&#160;</a></span>VMCRBestParams_() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;<a class="el" href="group__lexic-types.html#gac054642b806e57a890d98da54fc37d8b">Dimension</a> D, <a class="el" href="group__lexic-types.html#ga7180e1fd6dc0f5d4711ca838823f55c3">ParticNum</a> N, <a class="el" href="group__lexic-types.html#ga6bd28161ae7a0119b328705a0fc07441">VarParNum</a> V, class Wavefunction , class LocEnAndPossCalculator &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structvmcp_1_1VMCResult.html">VMCResult</a>&lt; V &gt; vmcp::VMCRBestParams_ </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__lexic-types.html#ga056b415cd8cb5c6ea875f449f819645c">VarParams</a>&lt; V &gt;&#160;</td>
          <td class="paramname"><em>initialParams</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__lexic-types.html#gacccffa7caec2adfb7d3ea5c2244422eb">ParamBounds</a>&lt; V &gt;&#160;</td>
          <td class="paramname"><em>bounds</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Wavefunction const &amp;&#160;</td>
          <td class="paramname"><em>wavef</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">LocEnAndPossCalculator const &amp;&#160;</td>
          <td class="paramname"><em>lepsCalc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__lexic-types.html#ga425e16aae8ec073f46fa42f58a3e96a5">StatFuncType</a>&#160;</td>
          <td class="paramname"><em>function</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__struct-types.html#ga829e1dd0a0d9ef3e7e95aa986d6edb7d">IntType</a> const &amp;&#160;</td>
          <td class="paramname"><em>boostrapSamples</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__struct-types.html#gac38d2867cc2daa23c78b29eee019cf9d">RandomGenerator</a> &amp;&#160;</td>
          <td class="paramname"><em>gen</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Computes the energy with error, with the parameters that minimize the former. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">initialParams</td><td>The initial variational parameters </td></tr>
    <tr><td class="paramname">wavef</td><td>The wavefunction </td></tr>
    <tr><td class="paramname">lepsCalc</td><td>A function that takes as input the variational parameters and returns the local energies and the positions of the particles when each one was computed </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The energy with error</dd></dl>
<p>Does gradient descent starting from the given parameters. Stops when the proposed step is too small compared to the current parameters. Computes the gradient by using reweighting. After having computed the gradient, if the proposed step would increase the energy too much, proposes a new step of half the length, and repeats. </p>

<p class="definition">Definition at line <a class="el" href="vmcalgs_8inl_source.html#l00129">129</a> of file <a class="el" href="vmcalgs_8inl_source.html">vmcalgs.inl</a>.</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.5
</small></address>
</body>
</html>
